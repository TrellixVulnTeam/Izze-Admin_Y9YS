(this["webpackJsonpizze-admin"]=this["webpackJsonpizze-admin"]||[]).push([[19],{647:function(e,a,t){"use strict";t.r(a),t.d(a,"EditProfile",(function(){return I})),t.d(a,"ChangePassword",(function(){return T}));var n=t(28),i=t.n(n),s=t(47),r=t(42),l=t(13),c=t(21),o=t(0),d=t.n(o),j=t(370),u=t(560),b=t(111),h=t(581),m=t(564),f=t(566),O=t(373),x=t(374),g=t(375),p=t(529),v=t(531),w=t(569),C=t(533),P=t(380),y=t(126),S=t(81),k=t(61),N=t(210),B=t.n(N),R=t(204),F=t(168),z=t(125),q=t(62),D=t(213),W=t(4),A=Object(j.a)((function(e){return{root:{width:e.breakpoints.values.lg,height:"100%",maxWidth:"100%",margin:"0 auto",padding:e.spacing(3)},paperStyle:{padding:e.spacing(8,8)},insidePaperDivStyle:{display:"flex",flexDirection:"column",justifyContent:"center",margin:"auto",alignItems:"center",height:"100%"},themeButton:{color:e.palette.white,backgroundColor:e.palette.green.main,"&:hover":{backgroundColor:e.palette.green.dark}},avatarStyle:{width:"150px",height:"150px"},lColor:{color:e.palette.green.main}}})),E={name:"",image:{file:null,prevImage:"",isNew:null}},I=function(e){var a=e.data,t=e.onRefresh,n=A(),o=d.a.useRef(null),j=d.a.useRef(null),b=Object(S.b)().Post,m=Object(k.a)(),f=d.a.useState(!1),O=Object(c.a)(f,2),x=O[0],y=O[1],N=d.a.useState(!1),I=Object(c.a)(N,2),V=I[0],T=I[1],_=d.a.useState(Object(l.a)({},E)),J=Object(c.a)(_,2),K=J[0],U=J[1];d.a.useEffect((function(){if(x){var e=a.image,t=a._id,n=Object(r.a)(a,["image","_id"]),i=Object(l.a)(Object(l.a)({},n),{},{id:t});i.image={file:e,prevImage:null===e||void 0===e?void 0:e.url,isNew:!1},console.log(i),U(i)}else U(E)}),[e,x]);var L=function(){T(!V)},G=function(e){e.persist();var a=e.target.files;if(a&&0!=a.length){var t=new FileReader,n=a[0];t.onloadend=function(){o.current.setFieldValue("image",{file:n,prevImage:t.result,isNew:!0})},t.readAsDataURL(n)}},H=function(){var e=Object(s.a)(i.a.mark((function e(a,t){var n,s,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.name,s=a.image,(r={}).name=n,e.next=5,Object(D.b)(s);case 5:r.image=e.sent,M(r,t);case 7:case"end":return e.stop()}}),e)})));return function(a,t){return e.apply(this,arguments)}}(),M=function(e,a){var n=a.setSubmitting,i=a.resetForm;b("app/updateAdminDetails",e).then((function(e){m.show(e.message,"success"),n(!1),i(),L(),t()})).catch((function(e){m.show(e.message,"error")}))};return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(g.a,{size:"small",onClick:function(){T(!V),y(!0)},className:n.themeButton,children:Object(W.jsx)(B.a,{fontSize:"small"})}),Object(W.jsxs)(p.a,{open:V,disableBackdropClick:!0,disableEscapeKeyDown:!0,fullWidth:!0,maxWidth:"sm","aria-labelledby":"dialog-title",children:[Object(W.jsx)(F.a,{id:"dialog-title",onClose:L,children:"Edit Profile"}),Object(W.jsx)(z.b,{innerRef:o,enableReinitialize:!0,initialValues:K,validationSchema:q.d().shape({name:q.f().required("Name is required"),image:q.d({file:q.b().required("A file is required")})}),onSubmit:H,children:function(e){var a,t=e.values,i=e.errors,s=e.touched,r=e.handleChange,l=e.handleBlur,c=(e.setFieldValue,e.submitForm),o=e.isSubmitting;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(v.a,{dividers:!0,children:Object(W.jsxs)(u.a,{container:!0,spacing:2,children:[Object(W.jsxs)(u.a,{item:!0,xs:12,children:[Object(W.jsx)("input",{name:"recipe_image",ref:j,type:"file",accept:".jpg,.png,jpeg",onChange:G,onBlur:l,hidden:!0}),Object(W.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(W.jsx)(h.a,{onClick:function(){return j.current.click()},className:n.avatarStyle,src:null===t||void 0===t||null===(a=t.image)||void 0===a?void 0:a.prevImage,alt:"profilePic",variant:"square"})})]}),Object(W.jsx)(u.a,{item:!0,xs:12,children:Object(W.jsx)(w.a,{fullWidth:!0,label:"Name",variant:"outlined",name:"name",value:t.name,onBlur:l,onChange:r,error:Boolean(s.name&&i.name),helperText:s.name&&i.name})})]})}),Object(W.jsxs)(C.a,{children:[Object(W.jsx)(P.a,{onClick:L,variant:"outlined",color:"secondary",children:"Cancel"}),Object(W.jsx)(P.a,{className:n.themeButton,onClick:function(){return c()},disabled:o,variant:"outlined",children:o?Object(W.jsx)(R.a,{size:24,style:{color:"white"}}):"Save"})]})]})}})]})]})},V={password:"",confirmPassword:""},T=function(e){var a=e.onRefresh,t=A(),n=d.a.useRef(null),i=d.a.useState(!1),s=Object(c.a)(i,2),r=s[0],o=s[1],j=Object(S.b)().Post,b=Object(k.a)(),h=d.a.useState(Object(l.a)({},V)),m=Object(c.a)(h,2),f=m[0],O=(m[1],function(){o(!r)}),x=function(e,t){var n=t.setSubmitting,i=t.resetForm;j("app/updateAdminPassword",e).then((function(e){e.error?(b.show(e.message,"success"),n(!1)):(b.show(e.message,"success"),n(!1),i(),O(),a())})).catch((function(e){n(!1),b.show(e.message,"error")}))};return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(P.a,{size:"small",onClick:function(){o(!r)},className:t.themeButton,children:"Change"}),Object(W.jsxs)(p.a,{open:r,disableBackdropClick:!0,disableEscapeKeyDown:!0,fullWidth:!0,maxWidth:"sm","aria-labelledby":"dialog-title",children:[Object(W.jsx)(F.a,{id:"dialog-title",onClose:O,children:"Change Password"}),Object(W.jsx)(z.b,{innerRef:n,enableReinitialize:!0,initialValues:f,validationSchema:q.d().shape({password:q.f().required("Password is required").min(6,"Password must be at least 6 characters"),confirmPassword:q.f().oneOf([q.e("password"),null],"Password must be same").required("Confirm password is required")}),onSubmit:function(e,a){var t=e.confirmPassword;x({password:t},a)},children:function(e){var a=e.values,n=e.errors,i=e.touched,s=e.handleChange,r=e.handleBlur,l=(e.setFieldValue,e.submitForm),c=e.isSubmitting;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsx)(v.a,{dividers:!0,children:Object(W.jsxs)(u.a,{container:!0,spacing:2,children:[Object(W.jsx)(u.a,{item:!0,xs:12,children:Object(W.jsx)(w.a,{fullWidth:!0,label:"New Password",variant:"outlined",name:"password",type:"password",value:a.password,onBlur:r,onChange:s,error:Boolean(i.password&&n.password),helperText:i.password&&n.password})}),Object(W.jsx)(u.a,{item:!0,xs:12,children:Object(W.jsx)(w.a,{fullWidth:!0,label:"Confirm Password",variant:"outlined",name:"confirmPassword",type:"password",value:a.confirmPassword,onBlur:r,onChange:s,error:Boolean(i.confirmPassword&&n.confirmPassword),helperText:i.confirmPassword&&n.confirmPassword})})]})}),Object(W.jsxs)(C.a,{children:[Object(W.jsx)(P.a,{onClick:O,variant:"outlined",color:"secondary",children:"Cancel"}),Object(W.jsx)(P.a,{className:t.themeButton,onClick:function(){return l()},disabled:c,variant:"outlined",children:c?Object(W.jsx)(R.a,{size:24,style:{color:"white"}}):"Submit"})]})]})}})]})]})};a.default=function(){var e,a=A(),t=Object(S.b)().Post,n=Object(k.a)(),i=d.a.useState(""),s=Object(c.a)(i,2),r=s[0],l=s[1],o=d.a.useState(!0),j=Object(c.a)(o,2),g=j[0],p=j[1],v=function(){p(!0),t("app/getAdminUser",{}).then((function(e){p(!1),e.error?n.show(e.message,"error"):l(e.data)})).catch((function(e){p(!1),n.show(e.message,"error")}))};return d.a.useEffect((function(){v()}),[]),Object(W.jsxs)("div",{className:a.root,children:[Object(W.jsx)(y.a,{title:"Admin Profile"}),Object(W.jsxs)(u.a,{container:!0,children:[Object(W.jsx)(u.a,{xs:!0,md:!0,item:!0}),Object(W.jsx)(u.a,{item:!0,xs:12,md:8,children:Object(W.jsxs)(b.a,{className:a.paperStyle,children:[!g&&Object(W.jsxs)("div",{className:a.insidePaperDivStyle,children:[Object(W.jsx)(h.a,{className:a.avatarStyle,src:null===r||void 0===r||null===(e=r.image)||void 0===e?void 0:e.url,alt:null===r||void 0===r?void 0:r.name,variant:"square"}),Object(W.jsx)(m.a,{children:Object(W.jsxs)(f.a,{children:[Object(W.jsxs)(O.a,{children:[Object(W.jsx)(x.a,{align:"left",children:"Name"}),Object(W.jsx)(x.a,{align:"center",children:null===r||void 0===r?void 0:r.name}),Object(W.jsx)(x.a,{align:"right",children:Object(W.jsx)(I,{data:r,onRefresh:v})})]}),Object(W.jsxs)(O.a,{children:[Object(W.jsx)(x.a,{align:"left",children:"Email"}),Object(W.jsx)(x.a,{align:"center",children:null===r||void 0===r?void 0:r.email}),Object(W.jsx)(x.a,{align:"right"})]}),Object(W.jsxs)(O.a,{children:[Object(W.jsx)(x.a,{align:"left",children:"Admin Type"}),Object(W.jsx)(x.a,{align:"center",children:null===r||void 0===r?void 0:r.user_type}),Object(W.jsx)(x.a,{align:"right"})]}),Object(W.jsxs)(O.a,{children:[Object(W.jsx)(x.a,{align:"left",children:"Password"}),Object(W.jsx)(x.a,{align:"center",children:"**********"}),Object(W.jsx)(x.a,{align:"right",children:Object(W.jsx)(T,{onRefresh:v})})]})]})})]}),g&&Object(W.jsx)("div",{className:a.insidePaperDivStyle,children:Object(W.jsx)(R.a,{className:a.lColor})})]})}),Object(W.jsx)(u.a,{xs:!0,md:!0,item:!0})]})]})}}}]);