{"ast":null,"code":"import _regeneratorRuntime from\"D:/Pyramidion/WebApp/Izze-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/Pyramidion/WebApp/Izze-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/Pyramidion/WebApp/Izze-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import firebase from'firebase';import React,{useEffect,useState}from'react';import{Outlet,useNavigate}from'react-router-dom';import Loader from'../../components/Loader/Loader';import TopNavBar from'../../components/TopNavBar/TopNavBar';import useService from'../../hook/useService';import useSnackbar from'../../hook/useSnackbar';import{useStore}from'../../Mobx/Helpers/UseStore';import{SigninRoute}from'../../Routes/RoutesConstants';import{AuthStateChange}from'../../utils/FirebaseUtils';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var HomeLayout=function HomeLayout(props){var _useService=useService(),Post=_useService.Post,Logout=_useService.Logout;var _useStore=useStore(),UserStore=_useStore.UserStore;var Snackbar=useSnackbar();var navigate=useNavigate();var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var authStateChanged=function authStateChanged(user){setLoading(true);if(user){UserStore.setIdToken(user.uid);Post('app/login').then(function(res){// console.log('login Res', res)\nUserStore.setUserDetails(res.data);// props.onRefresh()\nsetLoading(false);}).catch(function(err){console.log('login err',err.statusCode);Snackbar.show(err.message,'error');Logout().then(function(){return navigate(SigninRoute);});});}else{Logout().then(function(){return navigate(SigninRoute);});}};useEffect(function(){var unsubscribe=AuthStateChange(authStateChanged);return function(){return unsubscribe();};},[]);useEffect(function(){var unsubscribe=firebase.auth().onIdTokenChanged(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(user){var idToken;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return user===null||user===void 0?void 0:user.getIdToken();case 2:idToken=_context.sent;case 3:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());return function(){return unsubscribe();};},[]);useEffect(function(){var handle=setInterval(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var user;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:user=firebase.auth().currentUser;if(!user){_context2.next=4;break;}_context2.next=4;return user.getIdToken(true);case 4:case\"end\":return _context2.stop();}}},_callee2);})),58*60*1000);return function(){return clearInterval(handle);};},[]);return/*#__PURE__*/_jsx(_Fragment,{children:loading?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsx(TopNavBar,{children:/*#__PURE__*/_jsx(Outlet,{})})});};export default HomeLayout;","map":null,"metadata":{},"sourceType":"module"}