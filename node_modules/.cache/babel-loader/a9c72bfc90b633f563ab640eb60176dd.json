{"ast":null,"code":"import _toConsumableArray from\"D:/Pyramidion/WebApp/Izze-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectWithoutProperties from\"D:/Pyramidion/WebApp/Izze-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import _regeneratorRuntime from\"D:/Pyramidion/WebApp/Izze-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/Pyramidion/WebApp/Izze-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"D:/Pyramidion/WebApp/Izze-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"D:/Pyramidion/WebApp/Izze-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useRef}from'react';import{Avatar,Button,Card,CardActions,CardContent,CircularProgress,Dialog,DialogActions,DialogContent,Grid,IconButton,makeStyles,Table,TableBody,FormControl,FormHelperText,TableCell,TableContainer,TableHead,TableRow,TextField,Tooltip,Typography}from'@material-ui/core';import List from'@material-ui/core/List';import ListItem from'@material-ui/core/ListItem';import ListItemAvatar from'@material-ui/core/ListItemAvatar';import ListItemText from'@material-ui/core/ListItemText';import AddIcon from'@material-ui/icons/Add';import CenterFocusStrongIcon from'@material-ui/icons/CenterFocusStrong';import DeleteIcon from'@material-ui/icons/Delete';import EditIcon from'@material-ui/icons/Edit';import{Pagination}from'@material-ui/lab';import TipTapEditor from'../../components/TipTapEditor/TipTapEditor';import Autocomplete from'@material-ui/lab/Autocomplete';import{Formik,getIn,useFormikContext,FieldArray}from'formik';import*as Yup from'yup';import DialogTitle from'../../components/DialogTitlle/DialogTitle';import{TableLoader,TableNoData}from'../../components/Loader/Loader';import Page from'../../components/Page/Page';import useConfModel from'../../hook/useConfModel';import useService from'../../hook/useService';import useSnackbar from'../../hook/useSnackbar';import ControlPointIcon from'@material-ui/icons/ControlPoint';import CloudUploadIcon from'@material-ui/icons/CloudUpload';import TimerIcon from'@material-ui/icons/Timer';import CarbsImages from'../../assets/Images/Carbs.png';import ProteinsImages from'../../assets/Images/Protein.png';import FatImages from'../../assets/Images/Fat.png';import UnitSelect from'../../components/UnitSelect/UnitSelect';import UnitDropdown from'../../utils/MetricUnits';import{uploadNewImage}from'../../utils/CloudinaryUtils';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{root:{width:theme.breakpoints.values.lg,maxWidth:'100%',margin:'0 auto',padding:theme.spacing(3)},themeButton:{color:theme.palette.white,backgroundColor:theme.palette.green.main,'&:hover':{backgroundColor:theme.palette.green.dark}},workouttermsavatar:{width:'100%',height:'100%'},deleteButton:{width:'100%',height:'50px'},timeText:{display:'flex',alignItems:'center'},content:{padding:0},inner:{minWidth:700},actions:{padding:theme.spacing(1),justifyContent:'center'},tabCard:{marginTop:theme.spacing(3)},sEvenly:{display:'flex',justifyContent:'space-evenly'},iconPadd:{padding:5},jCenter:{display:'flex',justifyContent:'center'},imageView:{width:'100%',height:'100%'},avatarRoot:{borderRadius:10,marginRight:15,width:theme.spacing(10),height:theme.spacing(10)},textPrimary:{marginTop:10,fontWeight:'bold'},textSecondary:{marginTop:10},ingrdientsGridMain:{marginTop:10},ingredientsAvatarRoot:{width:theme.spacing(7),height:theme.spacing(7),margin:'auto'},htmlContentGrid:{paddingLeft:theme.spacing(3),paddingRight:theme.spacing(3),paddingTop:theme.spacing(1)},noIngredientsText:{marginBottom:theme.spacing(3),display:'flex',justifyContent:'center'},textareaAdornedEnd:{paddingRight:0},htmlContent:{'& ul':{paddingLeft:'1.2rem'},'& p':{textAlign:'justify'}}};});function MealRecipe(){var classes=useStyles();var ConfModel=useConfModel();var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),loading=_React$useState2[0],setLoading=_React$useState2[1];var _React$useState3=React.useState([]),_React$useState4=_slicedToArray(_React$useState3,2),mealRecipeTableData=_React$useState4[0],setMealRecipeTableData=_React$useState4[1];var _React$useState5=React.useState({page_no:1,page_limit:10}),_React$useState6=_slicedToArray(_React$useState5,2),stateData=_React$useState6[0],setStateData=_React$useState6[1];var _React$useState7=React.useState(0),_React$useState8=_slicedToArray(_React$useState7,2),pageCount=_React$useState8[0],setPageCount=_React$useState8[1];var _useService=useService(),Post=_useService.Post;var Snackbar=useSnackbar();var _React$useState9=React.useState({isOpen:false,title:'',okBtnText:'',isEdit:false,data:{}}),_React$useState10=_slicedToArray(_React$useState9,2),addEditDialog=_React$useState10[0],setAddEditDialog=_React$useState10[1];var _React$useState11=React.useState({isOpen:false,title:'',data:{}}),_React$useState12=_slicedToArray(_React$useState11,2),viewDialog=_React$useState12[0],setViewDialog=_React$useState12[1];var openAddDialog=function openAddDialog(){setAddEditDialog(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isOpen:true,title:'Add Meal Recipe',isEdit:false,okBtnText:'Save'});});};var openEditDialog=function openEditDialog(data){setAddEditDialog(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isOpen:true,isEdit:true,data:data,title:'Edit Meal Recipe',okBtnText:'Edit'});});};var openViewDialog=function openViewDialog(data){setViewDialog(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isOpen:true,data:data,title:'View Meal Recipe'});});};var listMealRecipies=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);Post('app/listMealRecipe',stateData).then(function(res){setLoading(false);if(!res.error){setMealRecipeTableData(res.data);setPageCount(res.page_count);}else{Snackbar.show(res.message,'error');}}).catch(function(err){setLoading(false);Snackbar.show(err.message,'error');});case 2:case\"end\":return _context.stop();}}},_callee);}));return function listMealRecipies(){return _ref.apply(this,arguments);};}();var onDelete=function onDelete(data){var openModel=ConfModel.openModel,setLoading=ConfModel.setLoading,closeModel=ConfModel.closeModel;var submitFunction=function submitFunction(){setLoading(true);Post('app/deleteMealRecipe',{id:data._id}).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(res){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setLoading(false);closeModel();onSuccessAction();Snackbar.show(res.message,'success');case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}()).catch(function(err){setLoading(false);Snackbar.show('Internal Server Error','error');});};openModel(submitFunction);};var onPageChange=function onPageChange(event,value){setStateData(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{page_no:value});});};var closeAddEditDialog=function closeAddEditDialog(){setAddEditDialog(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isOpen:false});});};var closeViewDialog=function closeViewDialog(){setViewDialog(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isOpen:false});});};var onSuccessAction=function onSuccessAction(){listMealRecipies();closeAddEditDialog();};var setElipsis=function setElipsis(text){return(text===null||text===void 0?void 0:text.length)>=25?\"\".concat(text.substring(0,40),\"...\"):text;};React.useEffect(function(){listMealRecipies();},[stateData]);return/*#__PURE__*/_jsxs(\"div\",{className:classes.root,children:[/*#__PURE__*/_jsx(Page,{title:\"Meal Recipe\"}),/*#__PURE__*/_jsxs(Grid,{alignItems:\"flex-end\",container:true,justify:\"space-between\",spacing:3,children:[/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Typography,{component:\"h1\",variant:\"h3\",children:\"Meal Recipe\"})}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:function onClick(){return openAddDialog();},className:classes.themeButton,startIcon:/*#__PURE__*/_jsx(AddIcon,{}),children:\"Add\"})})]}),/*#__PURE__*/_jsxs(Card,{className:classes.tabCard,children:[/*#__PURE__*/_jsx(CardContent,{className:classes.content,children:/*#__PURE__*/_jsx(TableContainer,{children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"#\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Meal Recipe Image\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Meal Recipe Name\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Actions\"})]})}),/*#__PURE__*/_jsxs(TableBody,{children:[!loading&&mealRecipeTableData.map(function(data,index){var _data$image;return/*#__PURE__*/_jsxs(TableRow,{hover:true,children:[/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:stateData.page_limit*(stateData.page_no-1)+index+1}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:/*#__PURE__*/_jsx(\"div\",{className:classes.jCenter,children:/*#__PURE__*/_jsx(Avatar,{variant:\"square\",src:data===null||data===void 0?void 0:(_data$image=data.image)===null||_data$image===void 0?void 0:_data$image.url})})}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:data===null||data===void 0?void 0:data.name}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:/*#__PURE__*/_jsxs(\"div\",{className:classes.sEvenly,children:[/*#__PURE__*/_jsx(Tooltip,{title:\"View\",arrow:true,children:/*#__PURE__*/_jsx(IconButton,{className:classes.iconPadd,onClick:function onClick(){return openViewDialog(data);},children:/*#__PURE__*/_jsx(CenterFocusStrongIcon,{color:\"primary\"})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Edit\",arrow:true,children:/*#__PURE__*/_jsx(IconButton,{className:classes.iconPadd,onClick:function onClick(){return openEditDialog(data);},children:/*#__PURE__*/_jsx(EditIcon,{color:\"action\"})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Delete\",arrow:true,children:/*#__PURE__*/_jsx(IconButton,{className:classes.iconPadd,onClick:function onClick(){return onDelete(data);},children:/*#__PURE__*/_jsx(DeleteIcon,{color:\"secondary\"})})})]})})]},index);}),loading&&/*#__PURE__*/_jsx(TableLoader,{}),!loading&&mealRecipeTableData.length==0&&/*#__PURE__*/_jsx(TableNoData,{children:\"No Data Found\"})]})]})})}),/*#__PURE__*/_jsx(CardActions,{className:classes.actions,children:/*#__PURE__*/_jsx(Pagination,{count:pageCount,page:stateData.page_no,onChange:onPageChange})})]}),/*#__PURE__*/_jsx(AddEditModel,_objectSpread(_objectSpread({},addEditDialog),{},{onClose:closeAddEditDialog,onSuccess:onSuccessAction})),/*#__PURE__*/_jsx(ViewModel,_objectSpread(_objectSpread({},viewDialog),{},{onClose:closeViewDialog}))]});}var mealTerms={name:'',image:{file:null,prevImage:'',isNew:null},term:''};var ingredientsSelect={id:'',quantity:'',quantity_unit:''};var initialFormValues={name:'',image:{file:null,prevImage:'',isNew:null},nutrition:'',description:'',protein:'',fat:'',carbs:'',terms:[mealTerms],ingredients:[ingredientsSelect],preparation_time:'',preparation_description:''};export var AddEditModel=function AddEditModel(props){var isEdit=props.isEdit,isOpen=props.isOpen,_props$okBtnText=props.okBtnText,okBtnText=_props$okBtnText===void 0?'OK':_props$okBtnText,onClose=props.onClose,data=props.data,title=props.title,onSuccess=props.onSuccess;var classes=useStyles();var _React$useState13=React.useState(_objectSpread({},initialFormValues)),_React$useState14=_slicedToArray(_React$useState13,2),initialValues=_React$useState14[0],setInitialValues=_React$useState14[1];var formikRef=React.useRef(null);var imageRef=React.useRef(null);var _React$useState15=React.useState([]),_React$useState16=_slicedToArray(_React$useState15,2),ingredientsList=_React$useState16[0],setIngredientsList=_React$useState16[1];var _useService2=useService(),Post=_useService2.Post;var Snackbar=useSnackbar();var onImageChange=function onImageChange(event){event.persist();var files=event.target.files;if(files&&files.length!=0){var reader=new FileReader();var file=files[0];reader.onloadend=function(){formikRef.current.setFieldValue('image',{file:file,prevImage:reader.result,isNew:true});};reader.readAsDataURL(file);}// else {\n//   formikRef.current.setFieldValue('image', {\n//     workoutTermsName: '',\n//     image: { file: null, prevImage: '', isNew: null },\n//     description: '',\n//   });\n// }\n};var onSubmit=function onSubmit(value,helper){try{helper.setSubmitting(true);var renderSubmit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var terms,rest,postData,TermPromiseArray,_yield$Promise$all,_yield$Promise$all2,imageResponse,TermImageResponse;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:terms=value.terms,rest=_objectWithoutProperties(value,[\"terms\"]);postData=rest;TermPromiseArray=Promise.all(terms.map(function(_ref4){var image=_ref4.image,rest=_objectWithoutProperties(_ref4,[\"image\"]);return uploadNewImage(image).then(function(imgResponse){return _objectSpread({image:imgResponse},rest);});}));_context3.next=5;return Promise.all([uploadNewImage(postData.image),TermPromiseArray]);case 5:_yield$Promise$all=_context3.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);imageResponse=_yield$Promise$all2[0];TermImageResponse=_yield$Promise$all2[1];postData.terms=TermImageResponse;postData.image=imageResponse;!isEdit&&addData(postData,helper);isEdit&&editData(postData,helper);// const TermPromiseArray = terms.map(async (termData: any) => {\n//   let { image, ...rest } = termData\n//   return uploadNewImage(image)\n// })\n// Promise.all(TermPromiseArray).then((termData: any) => {\n//   postData.terms = termData;\n//   return uploadNewImage(postData.image)\n// }).then((imageUrl: any) => {\n//   postData.image = imageUrl\n//   !isEdit && addData(postData, helper);\n//   isEdit && editData(postData, helper);\n// }).catch((err: any) => {\n//   Snackbar.show('Internal Server Error', 'error');\n// });\ncase 13:case\"end\":return _context3.stop();}}},_callee3);}));return function renderSubmit(){return _ref3.apply(this,arguments);};}();renderSubmit();}catch(_unused){Snackbar.show('Image Upload Failed','error');}};var addData=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(value,_ref5){var setSubmitting,resetForm;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setSubmitting=_ref5.setSubmitting,resetForm=_ref5.resetForm;_context4.next=3;return Post('app/addMealRecipe',value).then(function(res){Snackbar.show(res.message,'success');setSubmitting(false);resetForm();onSuccess();}).catch(function(err){Snackbar.show(err.message,'error');});case 3:case\"end\":return _context4.stop();}}},_callee4);}));return function addData(_x2,_x3){return _ref6.apply(this,arguments);};}();var editData=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(data,_ref7){var setSubmitting,resetForm;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:setSubmitting=_ref7.setSubmitting,resetForm=_ref7.resetForm;setSubmitting(true);_context5.next=4;return Post('app/editMealRecipe',data).then(function(res){Snackbar.show(res.message,'success');setSubmitting(false);resetForm();onSuccess();}).catch(function(err){Snackbar.show(err.message,'error');});case 4:case\"end\":return _context5.stop();}}},_callee5);}));return function editData(_x4,_x5){return _ref8.apply(this,arguments);};}();var listAllMealRecipe=function listAllMealRecipe(){Post('app/listAllMealIngredient',{}).then(function(res){if(!res.error){var getequipmentList=res.data.map(function(data){data.id=data._id;return data;});setIngredientsList(getequipmentList);}else{Snackbar.show(res.message,'error');}}).catch(function(err){Snackbar.show(err.message,'error');});};var addMealRecipeTerms=function addMealRecipeTerms(values,push){var terms=values.terms;push(mealTerms);};var addIngredients=function addIngredients(values,push){var ingredients=values.ingredients;push(ingredientsSelect);};var removeIngredients=function removeIngredients(values,items,setFieldValue){var ingredients=values.ingredients;var sampleDummyArray=_toConsumableArray(ingredients);sampleDummyArray.splice(sampleDummyArray.indexOf(items),1);setFieldValue('ingredients',sampleDummyArray);};var handleOptionChange=function handleOptionChange(event,value,index){formikRef.current.setFieldValue(\"ingredients[\".concat(index,\"].id\"),value===null||value===void 0?void 0:value.id);};React.useEffect(function(){listAllMealRecipe();},[]);React.useEffect(function(){if(isEdit){console.log(data);var terms=data.terms,image=data.image,_id=data._id,ingredients=data.ingredients,rest=_objectWithoutProperties(data,[\"terms\",\"image\",\"_id\",\"ingredients\"]);var _editData=_objectSpread(_objectSpread({},rest),{},{id:_id});var RecipeIds=ingredientsList.map(function(_ref9){var _id=_ref9._id;return _id;});_editData.image={file:image,prevImage:image===null||image===void 0?void 0:image.url,isNew:false};_editData.ingredients=ingredients.filter(function(_ref10){var _id=_ref10._id;return RecipeIds.includes(_id);}).map(function(_ref11){var _id=_ref11._id,quantity=_ref11.quantity,quantity_unit=_ref11.quantity_unit;return{id:_id,quantity:quantity,quantity_unit:quantity_unit};});_editData.terms=terms.map(function(items){return{name:items.name,image:{file:items.image,prevImage:items.image.url,isNew:false},term:items.term};});setInitialValues(_editData);}else{setInitialValues(initialFormValues);}},[props]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(Dialog,{open:isOpen,disableBackdropClick:true,disableEscapeKeyDown:true,fullWidth:true,maxWidth:\"md\",\"aria-labelledby\":\"dialog-title\",children:[/*#__PURE__*/_jsx(DialogTitle,{id:\"dialog-title\",onClose:onClose,children:title}),/*#__PURE__*/_jsx(Formik,{innerRef:formikRef,enableReinitialize:true,initialValues:initialValues,onSubmit:onSubmit,validationSchema:Yup.object().shape({name:Yup.string().trim().required('Name is required'),nutrition:Yup.string().trim().required('Nutrition is required'),// description: Yup.string().trim().max(250, 'Must be 250 characters or less').required('Description is required'),\nprotein:Yup.number().typeError('Protein must be in number').required('Protein is required'),fat:Yup.number().typeError('Fat must be in number').required('Fat is required'),carbs:Yup.number().typeError('Carbs must be in number').required('Carbs is required'),terms:Yup.array().of(Yup.object().shape({name:Yup.string().trim().required('Meal recipe name is Required'),image:Yup.object({file:Yup.mixed().required('required')}),term:Yup.string().trim().max(250,'Must be 250 characters or less').required('Meal Recipe terms is Required')})),ingredients:Yup.array().of(Yup.object().shape({id:Yup.string().trim().required('Ingredients is Required'),quantity:Yup.number().typeError('Quantity must be in number').required('Quantity is Required'),quantity_unit:Yup.string().trim().required('Quantity unit is required')})),preparation_time:Yup.string().trim().required('Preparation time is required'),preparation_description:Yup.string().required('Preparation description is required'),image:Yup.object({file:Yup.mixed().required('A file is required')})}),children:function children(_ref12){var _touched$image,_errors$image,_touched$image2,_errors$image2,_values$image,_values$image2;var values=_ref12.values,errors=_ref12.errors,touched=_ref12.touched,handleBlur=_ref12.handleBlur,handleChange=_ref12.handleChange,setFieldValue=_ref12.setFieldValue,submitForm=_ref12.submitForm,setFieldTouched=_ref12.setFieldTouched,isSubmitting=_ref12.isSubmitting;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(DialogContent,{dividers:true,children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Name\",name:\"name\",variant:\"outlined\",value:values.name,onChange:handleChange,onBlur:handleBlur,error:Boolean(touched.name&&errors.name),helperText:touched.name&&errors.name})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Nutrition\",name:\"nutrition\",variant:\"outlined\",value:values.nutrition,onChange:handleChange,onBlur:handleBlur,error:Boolean(touched.nutrition&&errors.nutrition),helperText:touched.nutrition&&errors.nutrition})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Protein ( g )\",name:\"protein\",variant:\"outlined\",value:values.protein,onChange:handleChange,onBlur:handleBlur,error:Boolean(touched.protein&&errors.protein),helperText:touched.protein&&errors.protein})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Fat ( g )\",name:\"fat\",variant:\"outlined\",value:values.fat,onChange:handleChange,onBlur:handleBlur,error:Boolean(touched.fat&&errors.fat),helperText:touched.fat&&errors.fat})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Carbs ( g )\",name:\"carbs\",variant:\"outlined\",value:values.carbs,onChange:handleChange,onBlur:handleBlur,error:Boolean(touched.carbs&&errors.carbs),helperText:touched.carbs&&errors.carbs})}),/*#__PURE__*/_jsx(FieldArray,{name:\"terms\",validateOnChange:true,children:function children(_ref13){var _values$terms;var push=_ref13.push,remove=_ref13.remove;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Grid,{item:true,md:12,xs:12,children:/*#__PURE__*/_jsx(Button,{fullWidth:true,className:classes.themeButton,variant:\"contained\",color:\"default\",onClick:function onClick(){return addMealRecipeTerms(values,push);},endIcon:/*#__PURE__*/_jsx(ControlPointIcon,{}),children:\"Add Terms\"})}),values===null||values===void 0?void 0:(_values$terms=values.terms)===null||_values$terms===void 0?void 0:_values$terms.map(function(items,index){var _values$terms2;return/*#__PURE__*/_jsx(TermsComponent,{index:index,remove:remove,getLength:values===null||values===void 0?void 0:(_values$terms2=values.terms)===null||_values$terms2===void 0?void 0:_values$terms2.length},index);})]});}}),/*#__PURE__*/_jsx(FieldArray,{name:\"ingredients\",children:function children(_ref14){var _values$ingredients;var push=_ref14.push,remove=_ref14.remove;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Grid,{item:true,md:12,xs:12,children:/*#__PURE__*/_jsx(Button,{fullWidth:true,className:classes.themeButton,variant:\"contained\",color:\"default\",onClick:function onClick(){return addIngredients(values,push);},endIcon:/*#__PURE__*/_jsx(ControlPointIcon,{}),children:\"Add Ingredients\"})}),values===null||values===void 0?void 0:(_values$ingredients=values.ingredients)===null||_values$ingredients===void 0?void 0:_values$ingredients.map(function(items,index){var _touched$ingredients$3,_errors$ingredients$i3,_touched$ingredients$4,_errors$ingredients$i4,_values$ingredients2;return/*#__PURE__*/_jsxs(Grid,{item:true,container:true,md:12,xs:12,direction:\"row\",spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,md:5,xs:12,children:/*#__PURE__*/_jsx(Autocomplete,{fullWidth:true,options:ingredientsList,value:ingredientsList.find(function(data){return data._id==items.id;}),getOptionLabel:function getOptionLabel(option){return option.name;},getOptionSelected:function getOptionSelected(option){return option.id==items.id;},onChange:function onChange(event,newValue){return handleOptionChange(event,newValue,index);},onBlur:handleBlur,renderInput:function renderInput(params){var _touched$ingredients$,_errors$ingredients$i,_touched$ingredients$2,_errors$ingredients$i2;return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{label:\"Ingredients\",variant:\"outlined\",error:Boolean((touched===null||touched===void 0?void 0:touched.ingredients)&&(touched===null||touched===void 0?void 0:(_touched$ingredients$=touched.ingredients[index])===null||_touched$ingredients$===void 0?void 0:_touched$ingredients$.id)&&(errors===null||errors===void 0?void 0:errors.ingredients)&&(errors===null||errors===void 0?void 0:(_errors$ingredients$i=errors.ingredients[index])===null||_errors$ingredients$i===void 0?void 0:_errors$ingredients$i.id)),helperText:(touched===null||touched===void 0?void 0:touched.ingredients)&&(touched===null||touched===void 0?void 0:(_touched$ingredients$2=touched.ingredients[index])===null||_touched$ingredients$2===void 0?void 0:_touched$ingredients$2.id)&&(errors===null||errors===void 0?void 0:errors.ingredients)&&(errors===null||errors===void 0?void 0:(_errors$ingredients$i2=errors.ingredients[index])===null||_errors$ingredients$i2===void 0?void 0:_errors$ingredients$i2.id),inputProps:_objectSpread({},params.inputProps)}));}})}),/*#__PURE__*/_jsx(Grid,{item:true,md:6,xs:8,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Quantity\",name:\"ingredients[\".concat(index,\"].quantity\"),variant:\"outlined\",error:Boolean((touched===null||touched===void 0?void 0:touched.ingredients)&&(touched===null||touched===void 0?void 0:(_touched$ingredients$3=touched.ingredients[index])===null||_touched$ingredients$3===void 0?void 0:_touched$ingredients$3.quantity)&&(errors===null||errors===void 0?void 0:errors.ingredients)&&(errors===null||errors===void 0?void 0:(_errors$ingredients$i3=errors.ingredients[index])===null||_errors$ingredients$i3===void 0?void 0:_errors$ingredients$i3.quantity)),helperText:(touched===null||touched===void 0?void 0:touched.ingredients)&&(touched===null||touched===void 0?void 0:(_touched$ingredients$4=touched.ingredients[index])===null||_touched$ingredients$4===void 0?void 0:_touched$ingredients$4.quantity)&&(errors===null||errors===void 0?void 0:errors.ingredients)&&(errors===null||errors===void 0?void 0:(_errors$ingredients$i4=errors.ingredients[index])===null||_errors$ingredients$i4===void 0?void 0:_errors$ingredients$i4.quantity),value:items.quantity,onChange:handleChange,onBlur:handleBlur,InputProps:{classes:{adornedEnd:classes.textareaAdornedEnd},endAdornment:/*#__PURE__*/_jsx(UnitSelect,{id:\"ingredients[\".concat(index,\"].quantity_unit\"),option:UnitDropdown,name:\"ingredients[\".concat(index,\"].quantity_unit\"),value:items.quantity_unit,onChange:handleChange,onBlur:handleBlur})}})}),(values===null||values===void 0?void 0:(_values$ingredients2=values.ingredients)===null||_values$ingredients2===void 0?void 0:_values$ingredients2.length)>1&&/*#__PURE__*/_jsx(Grid,{item:true,md:1,xs:4,children:/*#__PURE__*/_jsx(Button,{fullWidth:true,className:classes.deleteButton,variant:\"contained\",color:\"secondary\",onClick:function onClick(){return remove(index);},children:/*#__PURE__*/_jsx(DeleteIcon,{})})})]},index);})]});}}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Preparation Time\",name:\"preparation_time\",variant:\"outlined\",value:values.preparation_time,onChange:handleChange,onBlur:handleBlur,error:Boolean(touched.preparation_time&&errors.preparation_time),helperText:touched.preparation_time&&errors.preparation_time})}),/*#__PURE__*/_jsx(Grid,{item:true,md:12,xs:12,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,error:Boolean((touched===null||touched===void 0?void 0:touched.preparation_description)&&(errors===null||errors===void 0?void 0:errors.preparation_description)),children:[/*#__PURE__*/_jsx(TipTapEditor,{value:values.preparation_description,onChange:function onChange(value){return setFieldValue('preparation_description',value);},onBlur:function onBlur(){return setFieldTouched('preparation_description',true,true);}}),/*#__PURE__*/_jsx(FormHelperText,{children:(touched===null||touched===void 0?void 0:touched.preparation_description)&&(errors===null||errors===void 0?void 0:errors.preparation_description)})]})}),/*#__PURE__*/_jsxs(Grid,{item:true,md:12,xs:12,children:[/*#__PURE__*/_jsx(\"input\",{name:\"image\",ref:imageRef,type:\"file\",accept:\".jpg,.png,jpeg\",onChange:onImageChange,onBlur:handleBlur,hidden:true}),/*#__PURE__*/_jsx(Button,{fullWidth:true,className:classes.themeButton,variant:\"contained\",color:\"default\",onClick:function onClick(){return imageRef.current.click();},startIcon:/*#__PURE__*/_jsx(CloudUploadIcon,{}),children:\"Upload Image\"}),/*#__PURE__*/_jsx(FormControl,{error:Boolean((touched===null||touched===void 0?void 0:(_touched$image=touched.image)===null||_touched$image===void 0?void 0:_touched$image.file)&&(errors===null||errors===void 0?void 0:(_errors$image=errors.image)===null||_errors$image===void 0?void 0:_errors$image.file)),children:/*#__PURE__*/_jsx(FormHelperText,{children:(touched===null||touched===void 0?void 0:(_touched$image2=touched.image)===null||_touched$image2===void 0?void 0:_touched$image2.file)&&(errors===null||errors===void 0?void 0:(_errors$image2=errors.image)===null||_errors$image2===void 0?void 0:_errors$image2.file)})})]}),/*#__PURE__*/_jsx(Grid,{item:true,md:12,xs:12,children:((_values$image=values.image)===null||_values$image===void 0?void 0:_values$image.prevImage)&&/*#__PURE__*/_jsx(\"img\",{className:classes.imageView,src:(_values$image2=values.image)===null||_values$image2===void 0?void 0:_values$image2.prevImage})})]})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:onClose,variant:\"outlined\",color:\"secondary\",children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{className:classes.themeButton,onClick:function onClick(){return submitForm();},disabled:isSubmitting,variant:\"outlined\",children:isSubmitting?/*#__PURE__*/_jsx(CircularProgress,{size:24,style:{color:'white'}}):okBtnText})]})]});}})]})});};var TermsComponent=function TermsComponent(props){var _FieldValue$image,_FieldTouched$image,_FieldError$image,_FieldTouched$image2,_FieldError$image2;var FormikContext=useFormikContext();var values=FormikContext.values,errors=FormikContext.errors,touched=FormikContext.touched,setFieldValue=FormikContext.setFieldValue,handleBlur=FormikContext.handleBlur,handleChange=FormikContext.handleChange;var index=props.index;var classes=useStyles();var imgRef=useRef(null);var FieldName=\"terms[\".concat(index,\"]\");var FieldValue=getIn(values,\"terms[\".concat(index,\"]\"));var FieldError=getIn(errors,\"terms[\".concat(index,\"]\"));var FieldTouched=getIn(touched,\"terms[\".concat(index,\"]\"));var onImageChange=function onImageChange(event){event.persist();var files=event.target.files;if(files&&files.length!=0){var reader=new FileReader();var file=files[0];reader.onloadend=function(){setFieldValue(\"\".concat(FieldName,\".image\"),{file:file,prevImage:reader.result,isNew:true});};reader.readAsDataURL(file);}else{setFieldValue(\"\".concat(FieldName,\".image\"),{file:null,prevImage:'',isNew:null});}};return/*#__PURE__*/_jsxs(Grid,{item:true,container:true,md:12,xs:12,direction:\"row\",spacing:2,children:[/*#__PURE__*/_jsxs(Grid,{item:true,md:1,xs:12,children:[/*#__PURE__*/_jsx(\"input\",{name:\"\".concat(FieldName,\".image\"),ref:imgRef,type:\"file\",accept:\".jpg,.png,jpeg\",onChange:function onChange(e){return onImageChange(e);},onBlur:handleBlur,hidden:true}),/*#__PURE__*/_jsx(Avatar,{className:classes.workouttermsavatar,variant:\"square\",onClick:function onClick(){var _imgRef$current;return imgRef===null||imgRef===void 0?void 0:(_imgRef$current=imgRef.current)===null||_imgRef$current===void 0?void 0:_imgRef$current.click();},src:FieldValue===null||FieldValue===void 0?void 0:(_FieldValue$image=FieldValue.image)===null||_FieldValue$image===void 0?void 0:_FieldValue$image.prevImage}),/*#__PURE__*/_jsx(FormControl,{error:Boolean((FieldTouched===null||FieldTouched===void 0?void 0:(_FieldTouched$image=FieldTouched.image)===null||_FieldTouched$image===void 0?void 0:_FieldTouched$image.file)&&(FieldError===null||FieldError===void 0?void 0:(_FieldError$image=FieldError.image)===null||_FieldError$image===void 0?void 0:_FieldError$image.file)),children:/*#__PURE__*/_jsx(FormHelperText,{children:(FieldTouched===null||FieldTouched===void 0?void 0:(_FieldTouched$image2=FieldTouched.image)===null||_FieldTouched$image2===void 0?void 0:_FieldTouched$image2.file)&&(FieldError===null||FieldError===void 0?void 0:(_FieldError$image2=FieldError.image)===null||_FieldError$image2===void 0?void 0:_FieldError$image2.file)})})]}),/*#__PURE__*/_jsx(Grid,{item:true,md:5,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,multiline:true,label:\"Terms name\",name:\"\".concat(FieldName,\".name\"),variant:\"outlined\",error:Boolean((FieldTouched===null||FieldTouched===void 0?void 0:FieldTouched.name)&&(FieldError===null||FieldError===void 0?void 0:FieldError.name)),helperText:(FieldTouched===null||FieldTouched===void 0?void 0:FieldTouched.name)&&(FieldError===null||FieldError===void 0?void 0:FieldError.name),value:FieldValue.name,onChange:handleChange,onBlur:handleBlur})}),/*#__PURE__*/_jsx(Grid,{item:true,md:5,xs:8,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,multiline:true,label:\"Terms description\",name:\"\".concat(FieldName,\".term\"),variant:\"outlined\",error:Boolean((FieldTouched===null||FieldTouched===void 0?void 0:FieldTouched.term)&&(FieldError===null||FieldError===void 0?void 0:FieldError.term)),helperText:(FieldTouched===null||FieldTouched===void 0?void 0:FieldTouched.term)&&(FieldError===null||FieldError===void 0?void 0:FieldError.term),value:FieldValue.term,onChange:handleChange,onBlur:handleBlur})}),props.getLength>1&&/*#__PURE__*/_jsx(Grid,{item:true,md:1,xs:4,children:/*#__PURE__*/_jsx(Button,{fullWidth:true,className:classes.deleteButton,variant:\"contained\",color:\"secondary\",onClick:function onClick(){return props.remove(index);},children:/*#__PURE__*/_jsx(DeleteIcon,{})})})]});};export var ViewModel=function ViewModel(props){var _formValue$image,_formValue$terms,_formValue$workout_te,_formValue$ingredient;var isOpen=props.isOpen,title=props.title,onClose=props.onClose,data=props.data;var classes=useStyles();var _React$useState17=React.useState(data),_React$useState18=_slicedToArray(_React$useState17,2),formValue=_React$useState18[0],setFormValue=_React$useState18[1];React.useEffect(function(){setFormValue(data);},[props]);return/*#__PURE__*/_jsxs(Dialog,{disableBackdropClick:true,disableEscapeKeyDown:true,fullWidth:true,maxWidth:\"sm\",\"aria-labelledby\":\"dialog-view-title\",open:isOpen,children:[/*#__PURE__*/_jsx(DialogTitle,{id:\"dialog-view-title\",onClose:onClose,children:title}),/*#__PURE__*/_jsxs(DialogContent,{dividers:true,children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"img\",{src:formValue===null||formValue===void 0?void 0:(_formValue$image=formValue.image)===null||_formValue$image===void 0?void 0:_formValue$image.url,alt:'Workout image',className:classes.imageView})}),/*#__PURE__*/_jsx(Typography,{variant:\"h4\",children:/*#__PURE__*/_jsx(\"strong\",{children:formValue===null||formValue===void 0?void 0:formValue.name})}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,className:classes.ingrdientsGridMain,justify:\"center\",children:[formValue===null||formValue===void 0?void 0:(_formValue$terms=formValue.terms)===null||_formValue$terms===void 0?void 0:_formValue$terms.map(function(value,index){var _value$image;return/*#__PURE__*/_jsxs(Grid,{item:true,xs:4,md:3,children:[/*#__PURE__*/_jsx(Avatar,{className:classes.ingredientsAvatarRoot,src:value===null||value===void 0?void 0:(_value$image=value.image)===null||_value$image===void 0?void 0:_value$image.url}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",align:\"center\",children:value===null||value===void 0?void 0:value.name}),/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",align:\"center\",children:value.term.length>=25?\"\".concat(value.term.substring(0,30),\"...\"):value.term})]},index);}),(formValue===null||formValue===void 0?void 0:(_formValue$workout_te=formValue.workout_terms)===null||_formValue$workout_te===void 0?void 0:_formValue$workout_te.length)==0&&/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:12,className:classes.noIngredientsText,children:/*#__PURE__*/_jsx(\"div\",{children:\"No Ingredients\"})})]}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",align:\"left\",style:{color:'#41A58D'},className:classes.textPrimary,children:\"INGREDIENTS\"}),formValue===null||formValue===void 0?void 0:(_formValue$ingredient=formValue.ingredients)===null||_formValue$ingredient===void 0?void 0:_formValue$ingredient.map(function(items,index){var _items$image;return/*#__PURE__*/_jsx(List,{children:/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Avatar,{className:classes.avatarRoot,src:(_items$image=items.image)===null||_items$image===void 0?void 0:_items$image.url})}),/*#__PURE__*/_jsx(ListItemText,{primary:items===null||items===void 0?void 0:items.name,secondary:items===null||items===void 0?void 0:items.description}),/*#__PURE__*/_jsxs(Typography,{children:[items.quantity,\" \",items.quantity_unit]})]})});}),/*#__PURE__*/_jsx(Typography,{variant:\"h5\",align:\"left\",style:{color:'#41A58D'},className:classes.textPrimary,children:\"NUTRITIONAL INFORMATION\"}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,className:classes.ingrdientsGridMain,justify:\"center\",children:[/*#__PURE__*/_jsxs(Grid,{item:true,xs:4,md:3,children:[/*#__PURE__*/_jsx(Avatar,{className:classes.ingredientsAvatarRoot,src:CarbsImages}),/*#__PURE__*/_jsx(Typography,{align:\"center\",children:\"Carbs\"}),/*#__PURE__*/_jsxs(Typography,{align:\"center\",children:[formValue===null||formValue===void 0?void 0:formValue.carbs,\"g\"]})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:4,md:3,children:[/*#__PURE__*/_jsx(Avatar,{className:classes.ingredientsAvatarRoot,src:ProteinsImages}),/*#__PURE__*/_jsx(Typography,{align:\"center\",children:\"Protein\"}),/*#__PURE__*/_jsxs(Typography,{align:\"center\",children:[formValue===null||formValue===void 0?void 0:formValue.protein,\"g\"]})]}),/*#__PURE__*/_jsxs(Grid,{item:true,xs:4,md:3,children:[/*#__PURE__*/_jsx(Avatar,{className:classes.ingredientsAvatarRoot,src:FatImages}),/*#__PURE__*/_jsx(Typography,{align:\"center\",children:\"Fat\"}),/*#__PURE__*/_jsxs(Typography,{align:\"center\",children:[formValue===null||formValue===void 0?void 0:formValue.fat,\"g\"]})]})]}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",align:\"left\",style:{color:'#41A58D',marginTop:'20px'},children:/*#__PURE__*/_jsx(\"strong\",{children:\"PREPARATION\"})}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",align:\"center\",className:classes.timeText,children:[/*#__PURE__*/_jsx(TimerIcon,{fontSize:\"inherit\"}),/*#__PURE__*/_jsx(\"span\",{children:formValue===null||formValue===void 0?void 0:formValue.preparation_time})]}),/*#__PURE__*/_jsx(Grid,{container:true,children:/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:12,className:classes.htmlContentGrid,children:/*#__PURE__*/_jsx(\"div\",{className:classes.htmlContent,dangerouslySetInnerHTML:{__html:formValue===null||formValue===void 0?void 0:formValue.preparation_description}})})})]}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsx(Button,{onClick:onClose,variant:\"outlined\",color:\"secondary\",children:\"Close\"})})]});};export default MealRecipe;","map":null,"metadata":{},"sourceType":"module"}