{"ast":null,"code":"import _slicedToArray from\"D:/Pyramidion/WebApp/Izze-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{Outlet,useNavigate}from'react-router-dom';import Loader from'../../components/Loader/Loader';import TopNavBar from'../../components/TopNavBar/TopNavBar';import useService from'../../hook/useService';import useSnackbar from'../../hook/useSnackbar';import{useStore}from'../../Mobx/Helpers/UseStore';import{SigninRoute}from'../../Routes/RoutesConstants';import{AuthStateChange}from'../../utils/FirebaseUtils';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var HomeLayout=function HomeLayout(){var _useService=useService(),Post=_useService.Post,Logout=_useService.Logout;var _useStore=useStore(),UserStore=_useStore.UserStore;var Snackbar=useSnackbar();var navigate=useNavigate();var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var authStateChanged=function authStateChanged(user){setLoading(true);if(user){localStorage.setItem('uid',user.uid);UserStore.setIdToken(user.uid);Post('app/login').then(function(res){console.log('login Res',res);setLoading(false);}).catch(function(err){console.log('login err',err.statusCode);Snackbar.show(err.message,'error');Logout().then(function(){return navigate(SigninRoute);});});}else{Logout().then(function(){return navigate(SigninRoute);});}};useEffect(function(){var unsubscribe=AuthStateChange(authStateChanged);return function(){return unsubscribe();};},[]);return/*#__PURE__*/_jsx(_Fragment,{children:loading?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsx(TopNavBar,{children:/*#__PURE__*/_jsx(Outlet,{})})});};export default HomeLayout;","map":{"version":3,"sources":["D:/Pyramidion/WebApp/Izze-Admin/src/pages/Layouts/HomeLayout.tsx"],"names":["React","useEffect","useState","Outlet","useNavigate","Loader","TopNavBar","useService","useSnackbar","useStore","SigninRoute","AuthStateChange","HomeLayout","Post","Logout","UserStore","Snackbar","navigate","loading","setLoading","authStateChanged","user","localStorage","setItem","uid","setIdToken","then","res","console","log","catch","err","statusCode","show","message","unsubscribe"],"mappings":"sJAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OAASC,MAAT,CAAiBC,WAAjB,KAAoC,kBAApC,CACA,MAAOC,CAAAA,MAAP,KAAmB,gCAAnB,CACA,MAAOC,CAAAA,SAAP,KAAsB,sCAAtB,CACA,MAAOC,CAAAA,UAAP,KAAuB,uBAAvB,CACA,MAAOC,CAAAA,WAAP,KAAwB,wBAAxB,CACA,OAASC,QAAT,KAAyB,6BAAzB,CACA,OAASC,WAAT,KAA4B,8BAA5B,CACA,OAASC,eAAT,KAAgC,2BAAhC,C,gGAEA,GAAMC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACvB,gBAAyBL,UAAU,EAAnC,CAAQM,IAAR,aAAQA,IAAR,CAAcC,MAAd,aAAcA,MAAd,CACA,cAAsBL,QAAQ,EAA9B,CAAQM,SAAR,WAAQA,SAAR,CACA,GAAMC,CAAAA,QAAQ,CAAGR,WAAW,EAA5B,CACA,GAAMS,CAAAA,QAAQ,CAAGb,WAAW,EAA5B,CACA,cAA8BF,QAAQ,CAAC,IAAD,CAAtC,wCAAOgB,OAAP,eAAgBC,UAAhB,eAEA,GAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACC,IAAD,CAAe,CACtCF,UAAU,CAAC,IAAD,CAAV,CACA,GAAIE,IAAJ,CAAU,CACRC,YAAY,CAACC,OAAb,CAAqB,KAArB,CAA4BF,IAAI,CAACG,GAAjC,EACAT,SAAS,CAACU,UAAV,CAAqBJ,IAAI,CAACG,GAA1B,EACAX,IAAI,CAAC,WAAD,CAAJ,CAAkBa,IAAlB,CAAuB,SAACC,GAAD,CAAc,CACnCC,OAAO,CAACC,GAAR,CAAY,WAAZ,CAAwBF,GAAxB,EACAR,UAAU,CAAC,KAAD,CAAV,CACD,CAHD,EAGGW,KAHH,CAGS,SAACC,GAAD,CAAc,CACrBH,OAAO,CAACC,GAAR,CAAY,WAAZ,CAAwBE,GAAG,CAACC,UAA5B,EACAhB,QAAQ,CAACiB,IAAT,CAAcF,GAAG,CAACG,OAAlB,CAA2B,OAA3B,EACApB,MAAM,GAAGY,IAAT,CAAc,iBAAMT,CAAAA,QAAQ,CAACP,WAAD,CAAd,EAAd,EACD,CAPD,EAQD,CAXD,IAWO,CACLI,MAAM,GAAGY,IAAT,CAAc,iBAAMT,CAAAA,QAAQ,CAACP,WAAD,CAAd,EAAd,EACD,CACF,CAhBD,CAkBAT,SAAS,CAAC,UAAM,CACd,GAAMkC,CAAAA,WAAW,CAAGxB,eAAe,CAACS,gBAAD,CAAnC,CACA,MAAO,kBAAMe,CAAAA,WAAW,EAAjB,EAAP,CACD,CAHQ,CAGN,EAHM,CAAT,CAKA,mBAEE,yBACGjB,OAAO,cAAI,KAAC,MAAD,IAAJ,cAAiB,KAAC,SAAD,wBACvB,KAAC,MAAD,IADuB,EAD3B,EAFF,CASD,CAvCD,CAyCA,cAAeN,CAAAA,UAAf","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Outlet, useNavigate } from 'react-router-dom';\r\nimport Loader from '../../components/Loader/Loader';\r\nimport TopNavBar from '../../components/TopNavBar/TopNavBar';\r\nimport useService from '../../hook/useService';\r\nimport useSnackbar from '../../hook/useSnackbar';\r\nimport { useStore } from '../../Mobx/Helpers/UseStore';\r\nimport { SigninRoute } from '../../Routes/RoutesConstants';\r\nimport { AuthStateChange } from '../../utils/FirebaseUtils';\r\n\r\nconst HomeLayout = () => {\r\n  const { Post, Logout } = useService()\r\n  const { UserStore } = useStore()\r\n  const Snackbar = useSnackbar()\r\n  const navigate = useNavigate()\r\n  const [loading, setLoading] = useState(true)\r\n\r\n  const authStateChanged = (user: any) => {\r\n    setLoading(true)\r\n    if (user) {\r\n      localStorage.setItem('uid', user.uid);\r\n      UserStore.setIdToken(user.uid);\r\n      Post('app/login').then((res: any) => {\r\n        console.log('login Res',res)\r\n        setLoading(false)\r\n      }).catch((err: any) => {\r\n        console.log('login err',err.statusCode)\r\n        Snackbar.show(err.message, 'error');\r\n        Logout().then(() => navigate(SigninRoute))\r\n      })\r\n    } else {\r\n      Logout().then(() => navigate(SigninRoute))\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = AuthStateChange(authStateChanged);\r\n    return () => unsubscribe();\r\n  }, []);\r\n\r\n  return (\r\n\r\n    <>\r\n      {loading ?  <Loader /> : <TopNavBar>\r\n        <Outlet />\r\n      </TopNavBar>}\r\n    </>\r\n\r\n  );\r\n};\r\n\r\nexport default HomeLayout;\r\n"]},"metadata":{},"sourceType":"module"}