{"ast":null,"code":"import _objectWithoutProperties from\"D:/Pyramidion/WebApp/Izze-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import _objectSpread from\"D:/Pyramidion/WebApp/Izze-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"D:/Pyramidion/WebApp/Izze-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/Pyramidion/WebApp/Izze-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/Pyramidion/WebApp/Izze-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{Avatar,Button,Card,CardActions,CardContent,CircularProgress,Dialog,DialogActions,DialogContent,Grid,IconButton,makeStyles,Table,TableBody,FormControl,FormHelperText,TableCell,TableContainer,TableHead,TableRow,TextField,Tooltip,Divider,Typography,Accordion,AccordionSummary,AccordionDetails}from'@material-ui/core';import List from'@material-ui/core/List';import ListItem from'@material-ui/core/ListItem';import ListItemAvatar from'@material-ui/core/ListItemAvatar';import ListItemText from'@material-ui/core/ListItemText';import ListItemIcon from'@material-ui/core/ListItemIcon';import AddIcon from'@material-ui/icons/Add';import CenterFocusStrongIcon from'@material-ui/icons/CenterFocusStrong';import DeleteIcon from'@material-ui/icons/Delete';import EditIcon from'@material-ui/icons/Edit';import{Pagination}from'@material-ui/lab';import TipTapEditor from'../../components/TipTapEditor/TipTapEditor';import Autocomplete from'@material-ui/lab/Autocomplete';import{Formik}from'formik';import*as Yup from'yup';import DialogTitle from'../../components/DialogTitlle/DialogTitle';import{TableLoader,TableNoData}from'../../components/Loader/Loader';import Page from'../../components/Page/Page';import useConfModel from'../../hook/useConfModel';import useService from'../../hook/useService';import useSnackbar from'../../hook/useSnackbar';import CloudUploadIcon from'@material-ui/icons/CloudUpload';import{useEffect}from'react';import LikeImage from'../../assets/Images/like.png';import CommentImage from'../../assets/Images/comment.png';import CheckIcon from'@material-ui/icons/Check';import{uploadImageCloudinary}from'../../utils/CloudinaryUtils';import moment from'moment';import MobxObserver from'../../Mobx/Helpers/MobxObserver';import{useStore}from'../../Mobx/Helpers/UseStore';import{toJS}from'mobx';import SendIcon from'@material-ui/icons/Send';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var useStyle=makeStyles(function(theme){return{root:{width:theme.breakpoints.values.lg,maxWidth:'100%',margin:'0 auto',padding:theme.spacing(3)},greenColor:{color:theme.palette.green.main},themeButton:{color:theme.palette.white,backgroundColor:theme.palette.green.main,'&:hover':{backgroundColor:theme.palette.green.dark}},deleteButton:{width:'100%',height:'50px'},content:{padding:0},inner:{minWidth:700},actions:{padding:theme.spacing(1),justifyContent:'center'},tabCard:{marginTop:theme.spacing(3)},sEvenly:{display:'flex',justifyContent:'space-evenly'},iconPadd:{padding:5},jCenter:{display:'flex',justifyContent:'center'},imageView:{width:'100%',height:'100%'},avatarRoot:{borderRadius:10,marginRight:15,width:theme.spacing(10),height:theme.spacing(10)},textPrimary:{marginTop:10,fontWeight:'bold'},textSecondary:{marginTop:10},ingrdientsGridMain:{marginTop:10},ingredientsAvatarRoot:{width:theme.spacing(7),height:theme.spacing(7),margin:'auto'},htmlContentGrid:{paddingLeft:theme.spacing(3),paddingRight:theme.spacing(3),paddingTop:theme.spacing(1)},noIngredientsText:{marginBottom:theme.spacing(3),display:'flex',justifyContent:'center'},textareaAdornedEnd:{paddingRight:0},htmlContent:{'& ul':{paddingLeft:'1.2rem'},'& p':{textAlign:'justify',wordBreak:'break-word'}},likeCountImg:{width:theme.spacing(2),height:theme.spacing(2)},noCommentsText:{textAlign:'center'},justifyCenter:{justifyContent:'center'},blogTypeStyle:{backgroundColor:'#F2805E',color:'white',padding:'5px',borderRadius:'5px',fontSize:'14px',marginLeft:'10px',boxShadow:'none'},rejectButtonStyle:{backgroundColor:'red',color:'white',marginLeft:'10px','&:hover':{backgroundColor:'red'}},accordionRoot:{paddingLeft:theme.spacing(7),'&:before':{height:0}},accordionExpanded:{marginTop:'0 !important'},accordionDetailsRoot:{display:'unset',padding:0},accordionSummaryRoot:{display:'none'},width100:{width:'100%'},replyButtons:{padding:0,fontSize:\"0.7rem\",borderRadius:'unset',color:'#41a58d'}};});var Blogs=function Blogs(){var classes=useStyle();var _useService=useService(),Post=_useService.Post;var Snackbar=useSnackbar();var ConfModel=useConfModel();var _useState=useState({page_no:1,page_limit:10}),_useState2=_slicedToArray(_useState,2),stateData=_useState2[0],setStateData=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),pageCount=_useState4[0],setPageCount=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),dataList=_useState6[0],setDataList=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];var _React$useState=React.useState({isOpen:false,title:'',data:{}}),_React$useState2=_slicedToArray(_React$useState,2),viewDialog=_React$useState2[0],setViewDialog=_React$useState2[1];var _useState9=useState({isOpen:false,title:'',okBtnText:'',isEdit:false,data:{}}),_useState10=_slicedToArray(_useState9,2),addEditDialog=_useState10[0],setAddEditDialog=_useState10[1];var listBlog=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);Post('app/listBlog',stateData).then(function(res){console.log('listBlog',res);setLoading(false);if(!res.error){setDataList(res.data);setPageCount(res.page_count);}else{Snackbar.show(res.message,'error');}}).catch(function(err){console.log('err',err);setLoading(false);Snackbar.show(err.message,'error');});case 2:case\"end\":return _context.stop();}}},_callee);}));return function listBlog(){return _ref.apply(this,arguments);};}();var openAddDialog=function openAddDialog(){setAddEditDialog(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isOpen:true,title:'Add Blog Plan',isEdit:false,okBtnText:'Save'});});};var openEditDialog=function openEditDialog(data){setAddEditDialog(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isOpen:true,isEdit:true,data:data,title:'Edit Blog Plan',okBtnText:'Save'});});};var openViewDialog=function openViewDialog(data){setViewDialog(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isOpen:true,data:data,title:'View Blog Content'});});};var onDelete=function onDelete(data){var openModel=ConfModel.openModel,setLoading=ConfModel.setLoading,closeModel=ConfModel.closeModel;var submitFunction=function submitFunction(){setLoading(true);Post('app/deleteBlog',{id:data._id}).then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(res){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setLoading(false);closeModel();onSuccessAction();Snackbar.show(res.message,'success');case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}()).catch(function(err){setLoading(false);Snackbar.show('Internal Server Error','error');});};openModel(submitFunction);};var closeAddEditDialog=function closeAddEditDialog(){setAddEditDialog(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isOpen:false});});};var onPageChange=function onPageChange(event,value){setStateData(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{page_no:value});});};var onSuccessAction=function onSuccessAction(){listBlog();closeAddEditDialog();};var closeViewDialog=function closeViewDialog(){setViewDialog(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{isOpen:false});});};useEffect(function(){listBlog();},[stateData]);return/*#__PURE__*/_jsxs(\"div\",{className:classes.root,children:[/*#__PURE__*/_jsx(Page,{title:\"Blogs\"}),/*#__PURE__*/_jsxs(Grid,{alignItems:\"flex-end\",container:true,justify:\"space-between\",spacing:3,children:[/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Typography,{component:\"h1\",variant:\"h3\",children:\"Blogs\"})}),/*#__PURE__*/_jsx(Grid,{item:true,children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:function onClick(){return openAddDialog();},className:classes.themeButton,startIcon:/*#__PURE__*/_jsx(AddIcon,{}),children:\"Add\"})})]}),/*#__PURE__*/_jsxs(Card,{className:classes.tabCard,children:[/*#__PURE__*/_jsx(CardContent,{className:classes.content,children:/*#__PURE__*/_jsx(TableContainer,{children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"#\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Image\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Title\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Like Count\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Comment Count\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Unapprove Comment Count\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Action\"})]})}),/*#__PURE__*/_jsxs(TableBody,{children:[!loading&&dataList.map(function(data,index){var _data$image;return/*#__PURE__*/_jsxs(TableRow,{hover:true,children:[/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:stateData.page_limit*(stateData.page_no-1)+index+1}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:/*#__PURE__*/_jsx(\"div\",{className:classes.jCenter,children:/*#__PURE__*/_jsx(Avatar,{variant:\"square\",src:data===null||data===void 0?void 0:(_data$image=data.image)===null||_data$image===void 0?void 0:_data$image.url})})}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:data===null||data===void 0?void 0:data.title}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:data===null||data===void 0?void 0:data.like_count}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:data===null||data===void 0?void 0:data.comment_count}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:data===null||data===void 0?void 0:data.comment_unread_count}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:/*#__PURE__*/_jsxs(\"div\",{className:classes.sEvenly,children:[/*#__PURE__*/_jsx(Tooltip,{title:\"View\",arrow:true,children:/*#__PURE__*/_jsx(IconButton,{className:classes.iconPadd,onClick:function onClick(){return openViewDialog(data);},children:/*#__PURE__*/_jsx(CenterFocusStrongIcon,{color:\"primary\"})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Edit\",arrow:true,children:/*#__PURE__*/_jsx(IconButton,{className:classes.iconPadd,onClick:function onClick(){return openEditDialog(data);},children:/*#__PURE__*/_jsx(EditIcon,{color:\"action\"})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Delete\",arrow:true,children:/*#__PURE__*/_jsx(IconButton,{className:classes.iconPadd,onClick:function onClick(){return onDelete(data);},children:/*#__PURE__*/_jsx(DeleteIcon,{color:\"secondary\"})})})]})})]},index);}),loading&&/*#__PURE__*/_jsx(TableLoader,{}),!loading&&dataList.length==0&&/*#__PURE__*/_jsx(TableNoData,{children:\"No Data Found\"})]})]})})}),/*#__PURE__*/_jsx(CardActions,{className:classes.actions,children:/*#__PURE__*/_jsx(Pagination,{count:pageCount,page:stateData.page_no,onChange:onPageChange})})]}),addEditDialog.isOpen&&/*#__PURE__*/_jsx(AddEditModel,_objectSpread(_objectSpread({},addEditDialog),{},{onClose:closeAddEditDialog,onSuccess:onSuccessAction})),viewDialog.isOpen&&/*#__PURE__*/_jsx(ViewModel,_objectSpread(_objectSpread({},viewDialog),{},{onClose:closeViewDialog,onReload:function onReload(){return listBlog();}}))]});};var initialFormValue={description:'',blog_type:'',title:'',image:{file:null,prevImage:'',isNew:null},image_thumbnail:{file:null,prevImage:'',isNew:null}};var BlogTypes=[{id:'NUTRITION',name:'Nutririon'},{id:'MEAL',name:'Meal'},{id:'SKINCARE',name:'Skincare'},{id:'WORKOUT',name:'Workout'}];var getBlogDrop=function getBlogDrop(user_type){switch(user_type){case\"SKINCARE\":return[{id:'SKINCARE',name:'Skincare'}];break;case\"WORKOUT\":return[{id:'WORKOUT',name:'Workout'}];break;case\"NUTRITION\":return[{id:'NUTRITION',name:'Nutririon'},{id:'MEAL',name:'Meal'}];break;case\"CUSTOMERCARE\":return[];break;default:return BlogTypes;}};export var AddEditModel=MobxObserver(function(props){var classes=useStyle();var _useStore=useStore(),UserStore=_useStore.UserStore;var _toJS=toJS(UserStore.UserDetails),user_type=_toJS.user_type;var BlogTypeDrop=getBlogDrop(user_type);var isEdit=props.isEdit,isOpen=props.isOpen,_props$okBtnText=props.okBtnText,okBtnText=_props$okBtnText===void 0?'OK':_props$okBtnText,onClose=props.onClose,data=props.data,title=props.title,onSuccess=props.onSuccess;var _useState11=useState(_objectSpread({},initialFormValue)),_useState12=_slicedToArray(_useState11,2),initialValue=_useState12[0],setInitialValue=_useState12[1];var DisableUserType=['ADMIN','SUPERADMIN','NUTRITION'].includes(user_type)?false:true;var formikRef=React.useRef(null);var imageRef=React.useRef(null);var imageThumbnailRef=React.useRef(null);var Snackbar=useSnackbar();var _useService2=useService(),Post=_useService2.Post;var uploadNewImage=function uploadNewImage(imageData){var isNew=imageData.isNew,file=imageData.file;if(isNew){return uploadImageCloudinary(file);}else{return Promise.resolve(file);}};var onSubmit=function onSubmit(value,helper){try{helper.setSubmitting(true);var render=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var image,image_thumbnail,rest,PostData,_yield$Promise$all,_yield$Promise$all2,ImgRes,ImgTumpRes;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:image=value.image,image_thumbnail=value.image_thumbnail,rest=_objectWithoutProperties(value,[\"image\",\"image_thumbnail\"]);PostData=rest;_context3.next=4;return Promise.all([uploadNewImage(image),uploadNewImage(image_thumbnail)]);case 4:_yield$Promise$all=_context3.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);ImgRes=_yield$Promise$all2[0];ImgTumpRes=_yield$Promise$all2[1];PostData.image=ImgRes;PostData.image_thumbnail=ImgTumpRes;!isEdit&&addData(PostData,helper);isEdit&&editData(PostData,helper);case 12:case\"end\":return _context3.stop();}}},_callee3);}));return function render(){return _ref3.apply(this,arguments);};}();render();}catch(err){helper.setSubmitting(false);Snackbar.show('Image Upload Failed','error');}};var addData=function addData(data,_ref4){var setSubmitting=_ref4.setSubmitting,resetForm=_ref4.resetForm;setSubmitting(true);Post('app/addBlog',data).then(function(res){Snackbar.show(res.message,'success');setSubmitting(false);resetForm();onSuccess();}).catch(function(err){Snackbar.show(err.message,'error');});};var editData=function editData(data,_ref5){var setSubmitting=_ref5.setSubmitting,resetForm=_ref5.resetForm;setSubmitting(true);Post('app/editBlog',data).then(function(res){Snackbar.show(res.message,'success');setSubmitting(false);resetForm();onSuccess();}).catch(function(err){Snackbar.show(err.message,'error');});};var onImageChange=function onImageChange(event){event.persist();var files=event.target.files;var FieldName=event.target.name;if(files&&files.length!=0){var reader=new FileReader();var file=files[0];reader.onloadend=function(){formikRef.current.setFieldValue(FieldName,{file:file,prevImage:reader.result,isNew:true});};reader.readAsDataURL(file);}// else {\n//   formikRef.current.setFieldValue(FieldName, {\n//     file: null,\n//     prevImage: '',\n//     isNew: null,\n//   });\n// }\n};useEffect(function(){if(isEdit){var image=data.image,image_thumbnail=data.image_thumbnail,_id=data._id,rest=_objectWithoutProperties(data,[\"image\",\"image_thumbnail\",\"_id\"]);var EditData=_objectSpread(_objectSpread({},rest),{},{id:_id});EditData.image={file:image,prevImage:image.url,isNew:false};EditData.image_thumbnail={file:image_thumbnail,prevImage:image_thumbnail.url,isNew:false};setInitialValue(EditData);}else{initialFormValue.blog_type=DisableUserType?user_type:'';setInitialValue(initialFormValue);}},[props]);return/*#__PURE__*/_jsxs(Dialog,{open:isOpen,disableBackdropClick:true,disableEscapeKeyDown:true,fullWidth:true,maxWidth:\"md\",\"aria-labelledby\":\"dialog-title\",children:[/*#__PURE__*/_jsx(DialogTitle,{id:\"dialog-title\",onClose:onClose,children:title}),/*#__PURE__*/_jsx(Formik,{innerRef:formikRef,enableReinitialize:true,initialValues:initialValue,onSubmit:onSubmit,validationSchema:Yup.object().shape({description:Yup.string().trim().required('Blog Description is required'),blog_type:Yup.string().trim().required('Blog Type is required'),title:Yup.string().trim().required('Blog Title is required'),image:Yup.object({file:Yup.mixed().required('A file is required')}),image_thumbnail:Yup.object({file:Yup.mixed().required('A file is required')})}),children:function children(_ref6){var _touched$image,_errors$image,_touched$image2,_errors$image2,_touched$image_thumbn,_errors$image_thumbna,_touched$image_thumbn2,_errors$image_thumbna2,_values$image,_values$image2,_values$image_thumbna,_values$image_thumbna2;var values=_ref6.values,errors=_ref6.errors,touched=_ref6.touched,handleBlur=_ref6.handleBlur,handleChange=_ref6.handleChange,setFieldValue=_ref6.setFieldValue,submitForm=_ref6.submitForm,setFieldTouched=_ref6.setFieldTouched,isSubmitting=_ref6.isSubmitting;return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(DialogContent,{dividers:true,children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Title\",name:\"title\",variant:\"outlined\",value:values.title,onChange:handleChange,onBlur:handleBlur,error:Boolean(touched.title&&errors.title),helperText:touched.title&&errors.title})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(Autocomplete,{fullWidth:true,options:BlogTypeDrop,value:BlogTypeDrop.find(function(data){return data.id==values.blog_type;}),getOptionLabel:function getOptionLabel(option){return option.name;},disabled:DisableUserType,onChange:function onChange(event,newValue){setFieldValue('blog_type',(newValue===null||newValue===void 0?void 0:newValue.id)||'');},onBlur:handleBlur,renderInput:function renderInput(params){return/*#__PURE__*/_jsx(TextField,_objectSpread(_objectSpread({},params),{},{label:\"Blog Type\",variant:\"outlined\",error:Boolean(touched.blog_type&&errors.blog_type),helperText:touched.blog_type&&errors.blog_type,inputProps:_objectSpread({},params.inputProps)}));}})}),/*#__PURE__*/_jsx(Grid,{item:true,md:12,xs:12,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,error:Boolean((touched===null||touched===void 0?void 0:touched.description)&&(errors===null||errors===void 0?void 0:errors.description)),children:[/*#__PURE__*/_jsx(TipTapEditor,{value:values.description,onChange:function onChange(value){return setFieldValue('description',value);},onBlur:function onBlur(){return setFieldTouched('description',true,true);}}),/*#__PURE__*/_jsx(FormHelperText,{children:(touched===null||touched===void 0?void 0:touched.description)&&(errors===null||errors===void 0?void 0:errors.description)})]})}),/*#__PURE__*/_jsxs(Grid,{item:true,md:6,xs:12,children:[/*#__PURE__*/_jsx(\"input\",{name:\"image\",ref:imageRef,type:\"file\",accept:\".jpg,.png,jpeg\",onChange:onImageChange,onBlur:handleBlur,hidden:true}),/*#__PURE__*/_jsx(Button,{fullWidth:true,className:classes.themeButton,variant:\"contained\",color:\"default\",onClick:function onClick(){return imageRef.current.click();},startIcon:/*#__PURE__*/_jsx(CloudUploadIcon,{}),children:\"Upload Image\"}),/*#__PURE__*/_jsx(FormControl,{error:Boolean((touched===null||touched===void 0?void 0:(_touched$image=touched.image)===null||_touched$image===void 0?void 0:_touched$image.file)&&(errors===null||errors===void 0?void 0:(_errors$image=errors.image)===null||_errors$image===void 0?void 0:_errors$image.file)),children:/*#__PURE__*/_jsx(FormHelperText,{children:(touched===null||touched===void 0?void 0:(_touched$image2=touched.image)===null||_touched$image2===void 0?void 0:_touched$image2.file)&&(errors===null||errors===void 0?void 0:(_errors$image2=errors.image)===null||_errors$image2===void 0?void 0:_errors$image2.file)})})]}),/*#__PURE__*/_jsxs(Grid,{item:true,md:6,xs:12,children:[/*#__PURE__*/_jsx(\"input\",{name:\"image_thumbnail\",ref:imageThumbnailRef,type:\"file\",accept:\".jpg,.png,jpeg\",onChange:onImageChange,onBlur:handleBlur,hidden:true}),/*#__PURE__*/_jsx(Button,{fullWidth:true,className:classes.themeButton,variant:\"contained\",color:\"default\",onClick:function onClick(){return imageThumbnailRef.current.click();},startIcon:/*#__PURE__*/_jsx(CloudUploadIcon,{}),children:\"Upload Thumbnail\"}),/*#__PURE__*/_jsx(FormControl,{error:Boolean((touched===null||touched===void 0?void 0:(_touched$image_thumbn=touched.image_thumbnail)===null||_touched$image_thumbn===void 0?void 0:_touched$image_thumbn.file)&&(errors===null||errors===void 0?void 0:(_errors$image_thumbna=errors.image_thumbnail)===null||_errors$image_thumbna===void 0?void 0:_errors$image_thumbna.file)),children:/*#__PURE__*/_jsx(FormHelperText,{children:(touched===null||touched===void 0?void 0:(_touched$image_thumbn2=touched.image_thumbnail)===null||_touched$image_thumbn2===void 0?void 0:_touched$image_thumbn2.file)&&(errors===null||errors===void 0?void 0:(_errors$image_thumbna2=errors.image_thumbnail)===null||_errors$image_thumbna2===void 0?void 0:_errors$image_thumbna2.file)})})]}),/*#__PURE__*/_jsx(Grid,{item:true,md:6,xs:12,children:((_values$image=values.image)===null||_values$image===void 0?void 0:_values$image.prevImage)&&/*#__PURE__*/_jsx(\"img\",{className:classes.imageView,src:(_values$image2=values.image)===null||_values$image2===void 0?void 0:_values$image2.prevImage})}),/*#__PURE__*/_jsx(Grid,{item:true,md:6,xs:12,children:((_values$image_thumbna=values.image_thumbnail)===null||_values$image_thumbna===void 0?void 0:_values$image_thumbna.prevImage)&&/*#__PURE__*/_jsx(\"img\",{className:classes.imageView,src:(_values$image_thumbna2=values.image_thumbnail)===null||_values$image_thumbna2===void 0?void 0:_values$image_thumbna2.prevImage})})]})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:onClose,variant:\"outlined\",color:\"secondary\",children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{className:classes.themeButton,onClick:function onClick(){return submitForm();},disabled:isSubmitting,variant:\"outlined\",children:isSubmitting?/*#__PURE__*/_jsx(CircularProgress,{size:24,style:{color:'white'}}):okBtnText})]})]});}})]});});export var ViewModel=function ViewModel(props){var _formValue$image;var isOpen=props.isOpen,title=props.title,onClose=props.onClose,data=props.data,onReload=props.onReload;var classes=useStyle();var _useState13=useState(data),_useState14=_slicedToArray(_useState13,2),formValue=_useState14[0],setFormValue=_useState14[1];var _useService3=useService(),Post=_useService3.Post;var Snackbar=useSnackbar();var ConfModel=useConfModel();var _useState15=useState({id:data===null||data===void 0?void 0:data._id,page_no:1,page_limit:10}),_useState16=_slicedToArray(_useState15,2),stateData=_useState16[0],setStateData=_useState16[1];var _useState17=useState(0),_useState18=_slicedToArray(_useState17,2),pageCount=_useState18[0],setPageCount=_useState18[1];var _useState19=useState([]),_useState20=_slicedToArray(_useState19,2),dataList=_useState20[0],setDataList=_useState20[1];var _useState21=useState(true),_useState22=_slicedToArray(_useState21,2),loading=_useState22[0],setLoading=_useState22[1];var listBlogComments=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setLoading(true);Post('app/listBlogComments',stateData).then(function(res){console.log('listBlogComments',res);setLoading(false);if(!res.error){setDataList(res.data);setPageCount(res.page_count);}else{Snackbar.show(res.message,'error');}}).catch(function(err){console.log('err',err);setLoading(false);Snackbar.show(err.message,'error');});case 2:case\"end\":return _context4.stop();}}},_callee4);}));return function listBlogComments(){return _ref7.apply(this,arguments);};}();var onApprove=function onApprove(data){var openModel=ConfModel.openModel,setLoading=ConfModel.setLoading,closeModel=ConfModel.closeModel;var submitFunction=function submitFunction(){setLoading(true);Post('app/approveComment',{comment_id:data._id,blog_id:stateData.id}).then(/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(res){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:setLoading(false);closeModel();listBlogComments();onReload();Snackbar.show(res.message,'success');case 5:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x2){return _ref8.apply(this,arguments);};}()).catch(function(err){setLoading(false);Snackbar.show('Internal Server Error','error');});};openModel(submitFunction,\"Are you sure want to Approve\",\"Approve\");};var onReject=function onReject(data){var openModel=ConfModel.openModel,setLoading=ConfModel.setLoading,closeModel=ConfModel.closeModel;var submitFunction=function submitFunction(){setLoading(true);Post('app/rejectComment',{comment_id:data._id,blog_id:stateData.id}).then(/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(res){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:setLoading(false);closeModel();listBlogComments();onReload();Snackbar.show(res.message,'success');case 5:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x3){return _ref9.apply(this,arguments);};}()).catch(function(err){setLoading(false);Snackbar.show('Internal Server Error','error');});};openModel(submitFunction,\"Are you sure want to Reject\",\"Reject\");};var onPageChange=function onPageChange(event,value){setStateData(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{page_no:value});});};useEffect(function(){setFormValue(data);setStateData(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{id:data._id});});},[props.data]);useEffect(function(){listBlogComments();},[stateData]);return/*#__PURE__*/_jsxs(Dialog,{disableBackdropClick:true,disableEscapeKeyDown:true,fullWidth:true,maxWidth:\"sm\",\"aria-labelledby\":\"dialog-view-title\",open:isOpen,children:[/*#__PURE__*/_jsx(DialogTitle,{id:\"dialog-view-title\",onClose:onClose,children:title}),/*#__PURE__*/_jsxs(DialogContent,{dividers:true,children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"img\",{src:formValue===null||formValue===void 0?void 0:(_formValue$image=formValue.image)===null||_formValue$image===void 0?void 0:_formValue$image.url,className:classes.imageView})}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'20px'},children:/*#__PURE__*/_jsx(\"label\",{className:classes.blogTypeStyle,children:formValue===null||formValue===void 0?void 0:formValue.blog_type})}),/*#__PURE__*/_jsxs(List,{children:[/*#__PURE__*/_jsx(ListItem,{children:/*#__PURE__*/_jsx(ListItemText,{primary:/*#__PURE__*/_jsx(Typography,{variant:\"h5\",children:/*#__PURE__*/_jsx(\"strong\",{children:formValue===null||formValue===void 0?void 0:formValue.title})}),secondary:/*#__PURE__*/_jsxs(Typography,{variant:\"subtitle2\",children:[\"by \",/*#__PURE__*/_jsx(\"span\",{className:classes.greenColor,children:formValue===null||formValue===void 0?void 0:formValue.created_name}),\" . \",moment(formValue===null||formValue===void 0?void 0:formValue.created_at).format('MMM DD, YYYY')]})})}),/*#__PURE__*/_jsx(ListItem,{children:/*#__PURE__*/_jsx(ListItemText,{primary:/*#__PURE__*/_jsx(\"div\",{className:classes.htmlContent,dangerouslySetInnerHTML:{__html:formValue===null||formValue===void 0?void 0:formValue.description}})})}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemIcon,{children:/*#__PURE__*/_jsx(\"img\",{src:LikeImage,className:classes.likeCountImg,alt:\"like\"})}),/*#__PURE__*/_jsx(ListItemText,{primary:\"\".concat(formValue===null||formValue===void 0?void 0:formValue.like_count,\" Likes\")}),/*#__PURE__*/_jsx(ListItemIcon,{children:/*#__PURE__*/_jsx(\"img\",{src:CommentImage,className:classes.likeCountImg,alt:\"Comment\"})}),/*#__PURE__*/_jsx(ListItemText,{primary:\"\".concat(formValue===null||formValue===void 0?void 0:formValue.comment_count,\" Comments\")})]}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsx(ListItem,{children:/*#__PURE__*/_jsx(ListItemText,{primary:/*#__PURE__*/_jsx(Typography,{className:classes.ingrdientsGridMain,variant:\"h5\",children:/*#__PURE__*/_jsx(\"strong\",{children:\"Comments\"})})})}),!loading&&dataList.map(function(data,index){return/*#__PURE__*/_jsx(CommentItem,{data:data,onApprove:onApprove,onReject:onReject},index);}),loading&&/*#__PURE__*/_jsx(ListItem,{children:/*#__PURE__*/_jsx(ListItemText,{classes:{primary:classes.noCommentsText},primary:/*#__PURE__*/_jsx(CircularProgress,{className:classes.greenColor})})}),!loading&&dataList.length==0&&/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemText,{classes:{primary:classes.noCommentsText},primary:\"No Comments\"}),\" \"]}),/*#__PURE__*/_jsx(ListItem,{className:classes.justifyCenter,children:/*#__PURE__*/_jsx(Pagination,{count:pageCount,page:stateData.page_no,onChange:onPageChange})})]})]}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsx(Button,{onClick:onClose,variant:\"outlined\",color:\"secondary\",children:\"Close\"})})]});};var CommentItem=function CommentItem(props){var _commentData$reply;var classes=useStyle();var data=props.data,onApprove=props.onApprove,onReject=props.onReject;var _useState23=useState(data),_useState24=_slicedToArray(_useState23,2),commentData=_useState24[0],setCommentData=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),expand=_useState26[0],setExpand=_useState26[1];var pushReplyData=function pushReplyData(replyData){var reply=commentData.reply;reply.push(replyData);setCommentData(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{reply:reply});});};useEffect(function(){setCommentData(props.data);},[props.data]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Avatar,{src:commentData===null||commentData===void 0?void 0:commentData.comment_by_image})}),/*#__PURE__*/_jsx(ListItemText,{primary:/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",children:\"\".concat(commentData===null||commentData===void 0?void 0:commentData.comment_by_name,\" . \").concat(moment(commentData===null||commentData===void 0?void 0:commentData.created_at).format('MMM DD, YYYY'))}),secondary:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",children:commentData===null||commentData===void 0?void 0:commentData.comment}),/*#__PURE__*/_jsx(Grid,{container:true,direction:\"row\",justify:\"flex-start\",alignItems:\"center\",children:(commentData===null||commentData===void 0?void 0:commentData.status)==1&&/*#__PURE__*/_jsx(IconButton,{color:\"inherit\",\"aria-label\":\"like\",className:classes.replyButtons,onClick:function onClick(){return setExpand(function(prevState){return!prevState;});},children:(commentData===null||commentData===void 0?void 0:commentData.reply_count)?\"\".concat(commentData===null||commentData===void 0?void 0:commentData.reply_count,\" Replies\"):'Reply'})})]})}),(commentData===null||commentData===void 0?void 0:commentData.status)==0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(IconButton,{className:classes.themeButton,onClick:function onClick(){return onApprove(commentData);},children:/*#__PURE__*/_jsx(CheckIcon,{})}),/*#__PURE__*/_jsx(IconButton,{className:classes.rejectButtonStyle,onClick:function onClick(){return onReject(commentData);},children:/*#__PURE__*/_jsx(DeleteIcon,{})})]})]}),/*#__PURE__*/_jsxs(Accordion,{elevation:0,classes:{root:classes.accordionRoot,expanded:classes.accordionExpanded},expanded:expand,children:[/*#__PURE__*/_jsx(AccordionSummary,{className:classes.accordionSummaryRoot}),/*#__PURE__*/_jsxs(AccordionDetails,{className:classes.accordionDetailsRoot,children:[commentData===null||commentData===void 0?void 0:(_commentData$reply=commentData.reply)===null||_commentData$reply===void 0?void 0:_commentData$reply.map(function(replayData,index){return/*#__PURE__*/_jsx(ReplyItem,{data:replayData},index);}),/*#__PURE__*/_jsx(ReplyComments,{commentsData:commentData,onSuccess:pushReplyData})]})]})]});};var ReplyItem=function ReplyItem(props){var _replayData$reply_by_;var data=props.data;var _useState27=useState(data),_useState28=_slicedToArray(_useState27,2),replayData=_useState28[0],setReplyData=_useState28[1];useEffect(function(){setReplyData(props.data);},[props.data]);return/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(ListItemAvatar,{children:/*#__PURE__*/_jsx(Avatar,{src:replayData===null||replayData===void 0?void 0:(_replayData$reply_by_=replayData.reply_by_image)===null||_replayData$reply_by_===void 0?void 0:_replayData$reply_by_.url})}),/*#__PURE__*/_jsx(ListItemText,{primary:/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",children:\"\".concat(replayData===null||replayData===void 0?void 0:replayData.reply_by_name,\" . \").concat(moment(replayData===null||replayData===void 0?void 0:replayData.created_at).format('MMM DD, YYYY'))}),secondary:/*#__PURE__*/_jsx(Typography,{variant:\"subtitle2\",children:replayData===null||replayData===void 0?void 0:replayData.reply})})]});};var ReplyComments=function ReplyComments(props){var commentsData=props.commentsData,onSuccess=props.onSuccess;var blog_id=commentsData.blog_id,id=commentsData._id;var _useService4=useService(),Post=_useService4.Post;var Snackbar=useSnackbar();var _React$useState3=React.useState(''),_React$useState4=_slicedToArray(_React$useState3,2),reply=_React$useState4[0],setReply=_React$useState4[1];var handleReplyChange=function handleReplyChange(event){setReply(event.target.value);};var sendReplyMessage=function sendReplyMessage(){if(reply.trim()==''){Snackbar.show('Replay is Required','error');return;}var sentReplyData={blog_id:blog_id,comment_id:id,reply:reply};Post('app/addCommentReply',sentReplyData).then(function(res){Snackbar.show(res.message,'success');setReply('');onSuccess(res.data);}).catch(function(err){Snackbar.show(err.message,'error');console.log(err);});};return/*#__PURE__*/_jsxs(ListItem,{children:[/*#__PURE__*/_jsx(TextField,{multiline:true,fullWidth:true,placeholder:\"Reply...\",size:\"small\",variant:\"outlined\",value:reply,onChange:handleReplyChange}),/*#__PURE__*/_jsx(IconButton,{color:\"primary\",onClick:sendReplyMessage,children:/*#__PURE__*/_jsx(SendIcon,{})})]});};export default Blogs;","map":null,"metadata":{},"sourceType":"module"}